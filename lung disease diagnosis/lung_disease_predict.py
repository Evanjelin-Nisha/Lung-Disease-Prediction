# -*- coding: utf-8 -*-
"""lung_disease_predict.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/13S6Sz9wTxRjAr3bnu71fv7LLQT3m4QgR
"""

import numpy as np
import matplotlib.pyplot as plt
from tensorflow.keras.models import load_model
from tensorflow.keras.preprocessing import image
import os

# Load trained model
model = load_model("models/lung_disease_classifier_model.h5")

# Class indices mapping (must match training)
class_indices = {
    0: 'Bacterial Pneumonia',
    1: 'Corona Virus Disease',
    2: 'Normal',
    3: 'Tuberculosis',
    4: 'Viral Pneumonia'
}

# Path to image
img_path = "sample_image.jpg"  # Change this to your image path

# Preprocess image
img = image.load_img(img_path, target_size=(244, 244))
img_array = image.img_to_array(img) / 255.0
img_array = np.expand_dims(img_array, axis=0)

# Prediction
predictions = model.predict(img_array)
predicted_class = np.argmax(predictions)
confidence = np.max(predictions)

# Display result
plt.imshow(img)
plt.title(f"{class_indices[predicted_class]} ({confidence*100:.2f}%)")
plt.axis("off")
plt.show()